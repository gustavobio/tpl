{
    "contents" : "#' Remove the author(s) from a taxon name.\n#' \n#' This attempts to remove the authorities of a taxonomic name.\n#' \n#' @param taxon a character vector containing a single taxon\n#' @export\n#' @return a character vector\n#' @examples\n#' noauthors(\"Coffea arabica L.\")\n#' noauthors(\"Chrysophyllum argenteum subsp. nitidum (G.F.W.Meyer) T.D.Penn.\")\nnoauthors <- function(taxon) {\n  #taxon <- iconv(taxon, to = \"ASCII//TRANSLIT\"\n  taxon <- trim(taxon)\n  ident <- regmatches(taxon, regexpr(\"\\\\s+sp\\\\.+\\\\w*\", taxon))\n  subsp <- regmatches(taxon, regexpr(\"subsp\\\\.|var\\\\.\", taxon))\n  if (taxon == \"\" | is.na(taxon)) return(NA)\n  taxon.split <- strsplit(taxon, \" \")\n  taxon.split.unlist <- unlist(taxon.split)\n  if (length(taxon.split.unlist) == 1) return(taxon)\n  if (length(subsp) != 0L) {\n    taxon.split.subsp <- unlist(strsplit(taxon, \"\\\\ssubsp\\\\.\\\\s|\\\\svar\\\\.\\\\s\"))\n    taxon.split.subsp.1 <- unlist(strsplit(taxon.split.subsp[1], \" \"))\n    taxon.split.subsp.2 <- unlist(strsplit(taxon.split.subsp[2], \" \"))\n    res <- paste(paste(taxon.split.subsp.1[c(1, 2)], collapse = \" \"), subsp, taxon.split.subsp.2[1], collapse = \" \")\n    return(res)\n  }\n  if (grepl(\"^[a-z].*[a-z]+$\", taxon.split.unlist[2])) {\n    if (length(taxon.split.unlist) == 2) return(taxon)\n    matches <- unlist(lapply(taxon.split, function(x) x[3:length(x)] %in% words))\n    res <- paste(taxon.split.unlist[c(TRUE, TRUE, matches)], collapse = \" \")\n  } else {\n    matches <- unlist(lapply(taxon.split, function(x) x[2:length(x)] %in% words))\n    res <- paste(taxon.split.unlist[c(TRUE, matches)], collapse = \" \")\n  }\n  if (length(ident) == 0L) {\n    return(res)\n  } else {\n    return(paste(res, trim(ident)))\n  }\n}",
    "created" : 1402018905276.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2806417872",
    "id" : "25143481",
    "lastKnownWriteTime" : 1402145827,
    "path" : "~/Documents/tpl/R/remove.authors.R",
    "project_path" : "R/remove.authors.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}